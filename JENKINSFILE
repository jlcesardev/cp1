pipeline {
    agent any

     stages {
        stage('Get Code') {
            steps {
                // Obtener c√≥digo del repo
                git 'https://github.com/anieto-unir/helloworld.git'
                bat 'dir'
                echo WORKSPACE
            }
        }
    
        stage('Build') {
           steps {
              echo 'Eyyy, esto es Python. No hay que compilar nada!!!'
			  echo WORKSPACE
			  bat 'dir'
           }
        }
        
       
         stage('Unit') {
                steps {
                        bat '''
                         set PYTHONPATH=%WORKSPACE%
                         pytest --junitxml=result-unit.xml test\\unit
						'''
            }
        }    
                     
         stage('Rest') {
               steps {
                         bat '''
                set FLASK_APP=app\\api.py
                start flask run

                start java -jar C:\\wiremock\\wiremock-standalone-3.13.2.jar --port 9090 --root-dir test\\wiremock

                set PYTHONPATH=%WORKSPACE%
                pytest --junitxml=result-rest.xml test\\rest
                '''
                    }
          }
          
     }

}
